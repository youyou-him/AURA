<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AI Magazine - Overlay</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Lato:wght@300;400;700&family=Oswald:wght@400;700&family=Roboto:wght@400;700&family=Merriweather:wght@300;700&display=swap" rel="stylesheet">

  {# â–¼â–¼â–¼ [ìˆ˜ì • 1] Pythonì—ì„œ ë³´ë‚¸ 'styles'ì™€ 'layout_params'ë¥¼ ì‹¬í”Œí•˜ê²Œ ë³€ìˆ˜ì— ë‹´ê¸° â–¼â–¼â–¼ #}
  {% set s = data.styles if data.styles else {} %}
  {% set lp = data.layout_params.overlay.box if data.layout_params and data.layout_params.overlay else {} %}
  {# â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–² #}

  <style>
    :root {
      /* â–¼â–¼â–¼ [ìˆ˜ì • 2] Directorê°€ ì •í•´ì¤€ ìŠ¤íƒ€ì¼(s) ë³€ìˆ˜ ì—°ê²° â–¼â–¼â–¼ */
      
      /* í…ìŠ¤íŠ¸ ìƒ‰ìƒ (Directorê°€ ì§€ì •í•œ ê°’ ìš°ì„ , ì—†ìœ¼ë©´ í°ìƒ‰) */
      --text-main: {{ s.color_text_main | default('#ffffff') }};
      --text-sub: {{ s.color_text_sub | default('#eeeeee') }};
      
      /* í¬ì¸íŠ¸ ì»¬ëŸ¬ (Directorê°€ ì§€ì •í•œ Primary Color) */
      --accent: {{ s.color_bg | default('#ffffff') }};
      
      /* í°íŠ¸ (Directorê°€ ì§€ì •í•œ í°íŠ¸ íŒ¨ë°€ë¦¬) */
      --font-title: {{ s.font_title | default("'Playfair Display', serif") | safe }};
      --font-body: {{ s.font_body | default("'Lato', sans-serif") | safe }};

      /* ë ˆì´ì•„ì›ƒ (Directorê°€ ì§€ì •í•œ ìœ„ì¹˜ ë° ì •ë ¬) */
      --box-left: {{ lp.left_pct | default(8) }}%;
      --box-top: {{ lp.top_pct | default(10) }}%;
      --box-width: {{ lp.width_pct | default(60) }}%;
      --text-align: {{ lp.align | default('left') }};
    }

    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      background: #000;
      font-family: var(--font-body); /* Directorê°€ ì •í•œ ë³¸ë¬¸ í°íŠ¸ ì ìš© */
      overflow: hidden;
    }

    .page {
      width: 210mm;
      height: 297mm;
      position: relative;
      overflow: hidden;
      margin: 0 auto;
      background: #000;
    }

    .bg {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      z-index: 0;
    }

    /* ğŸŒŸ ì˜¤ë²„ë ˆì´ ë°•ìŠ¤ ìŠ¤íƒ€ì¼ */
    .overlay-box {
      position: absolute;
      z-index: 10;
      
      /* ìœ„ì—ì„œ ì„¤ì •í•œ ë³€ìˆ˜ë“¤ì´ ì—¬ê¸°ì„œ ì‘ë™í•¨ */
      left: var(--box-left);
      top: var(--box-top);
      width: var(--box-width);
      text-align: var(--text-align);
      
      color: var(--text-main);
      padding: 12mm 10mm;
      border-radius: 2px;
      
      /* ë°°ê²½: ê¸°ë³¸ì€ ë°˜íˆ¬ëª… ê²€ì • (ë‚˜ì¤‘ì— s.box_classesë¥¼ í™œìš©í•´ ë°”ê¿€ ìˆ˜ë„ ìˆìŒ) */
      background: rgba(0, 0, 0, 0.75); 
      
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      
      /* ğŸ¨ Directorì˜ Primary Colorê°€ ì—¬ê¸°ì„œ ì™¼ìª½ ì¤„ë¡œ ë‚˜íƒ€ë‚¨ */
      border-left: 6px solid var(--accent);
      
      border-top: 1px solid rgba(255,255,255,0.1);
      border-right: 1px solid rgba(255,255,255,0.1);
      border-bottom: 1px solid rgba(255,255,255,0.1);
      
      box-shadow: 0 20px 50px rgba(0,0,0,0.5);
    }

    .kicker {
      font-family: 'Oswald', sans-serif; /* í‚¤ì»¤ëŠ” Oswald ê³ ì • (ìŠ¤íƒ€ì¼ ìœ ì§€) */
      letter-spacing: 3px;
      text-transform: uppercase;
      font-size: 14px;
      
      color: var(--accent); /* í¬ì¸íŠ¸ ì»¬ëŸ¬ ì ìš© */
      margin-bottom: 16px;
      
      border-bottom: 1px solid var(--accent); /* ë°‘ì¤„ í¬ì¸íŠ¸ ì»¬ëŸ¬ */
      
      display: inline-block;
      padding-bottom: 4px;
      text-shadow: 0 2px 4px rgba(0,0,0,0.8);
    }

    h1 {
      font-family: var(--font-title); /* Director í°íŠ¸ ì ìš© */
      font-size: 52px;
      line-height: 1.1;
      margin: 0 0 16px 0;
      color: var(--text-main);
      text-shadow: 0 2px 10px rgba(0,0,0,1.0);
    }

    h3 {
      font-size: 20px;
      font-style: italic;
      font-weight: 300;
      margin: 0 0 20px 0;
      color: var(--text-sub);
      text-shadow: 0 2px 5px rgba(0,0,0,0.8);
    }

    p {
      font-size: 16px;
      line-height: 1.8;
      margin: 0;
      color: var(--text-main);
      opacity: 0.95;
      text-shadow: 0 1px 3px rgba(0,0,0,0.9);
    }

    .caption {
      margin-top: 24px;
      font-size: 12px;
      color: #cccccc;
      border-left: 2px solid var(--accent); /* ìº¡ì…˜ ë¼ì¸ í¬ì¸íŠ¸ ì»¬ëŸ¬ */
      padding-left: 10px;
    }
  </style>
</head>

<body>
  <div class="page">
    {# ë°°ê²½ ì´ë¯¸ì§€ #}
    {% if images and images.main_img %}
      <img class="bg" src="{{ images.main_img }}" alt="Cover" />
    {% else %}
      <div class="bg" style="background: #222;"></div>
    {% endif %}

    <div class="overlay-box">
      {# Kicker #}
      {% set pr = data.get('planner_result', {}) %}
      <div class="kicker">{{ pr.get('selected_type', 'EDITORIAL') | replace('TYPE_', '') }}</div>    

      {# ë³¸ë¬¸ ë‚´ìš© #}
      {% set m = (data.manuscript if data.manuscript is defined and data.manuscript else None) %}
      {% if m %}
        <h1>{{ m.headline | default('Untitled') }}</h1>
        <h3>{{ m.subhead | default('') }}</h3>
        <p>{{ m.body | replace('\n', '<br>') | default('') }}</p>
        {% if m.caption %}
          <div class="caption">{{ m.caption }}</div>
        {% endif %}
      
      {% elif data.content and data.content.blocks %}
        <h1>{{ data.content.blocks[0].headline | default('Untitled') }}</h1>
        <h3>{{ data.content.blocks[0].subhead | default('') }}</h3>
        <p>{{ data.content.blocks[0].body | replace('\n', '<br>') | default('') }}</p>
        {% if data.content.blocks[0].caption %}
          <div class="caption">{{ data.content.blocks[0].caption }}</div>
        {% endif %}
      
      {% else %}
        <h1>Generating Content...</h1>
        <p>Please wait while the AI writes your article.</p>
      {% endif %}
    </div>
  </div>
</body>
</html>