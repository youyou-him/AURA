<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AI Magazine - Overlay</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Lato:wght@300;400;700&family=Oswald:wght@400;700&display=swap" rel="stylesheet">

  {# Jinja2 ë³€ìˆ˜ ì„¸íŒ… #}
  {% set ds = data.design_spec.theme if data.design_spec and data.design_spec.theme else {} %}
  {% set colors = ds.colors if ds.colors else {} %}
  {% set fonts = ds.fonts if ds.fonts else {} %}
  {% set lp = data.layout_params.overlay.box if data.layout_params and data.layout_params.overlay and data.layout_params.overlay.box else {} %}

  <style>
    :root {
      /* ğŸš¨ ê°€ë…ì„±ì„ ìœ„í•´ í…ìŠ¤íŠ¸ëŠ” ë°ì€ìƒ‰ ê³ ì • */
      --text-main: #ffffff; 
      --text-sub: #eeeeee;
      
      /* ğŸ¨ [í¬ì¸íŠ¸] Directorê°€ ì •í•œ ë©”ì¸ ì»¬ëŸ¬ë¥¼ 'ì—‘ì„¼íŠ¸'ë¡œ ì‚¬ìš© */
      --accent: {{ colors.primary | default('#ffffff') }};
      
      --font-title: {{ fonts.title | default("'Playfair Display', serif") | safe }};
      --font-body: {{ fonts.body | default("'Lato', sans-serif") | safe }};

      /* ìœ„ì¹˜ ì¡ê¸° */
      --box-left: {{ lp.left_pct | default(8) }}%;
      --box-top: {{ lp.top_pct | default(10) }}%;
      --box-width: {{ lp.width_pct | default(60) }}%;
      --text-align: {{ lp.align | default('left') }};
    }

    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      background: #000;
      font-family: var(--font-body);
      overflow: hidden;
    }

    .page {
      width: 210mm;
      height: 297mm;
      position: relative;
      overflow: hidden;
      margin: 0 auto;
      background: #000;
    }

    .bg {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      z-index: 0;
    }

    /* ğŸŒŸ ì˜¤ë²„ë ˆì´ ë°•ìŠ¤ ìŠ¤íƒ€ì¼ */
    .overlay-box {
      position: absolute;
      z-index: 10;
      left: var(--box-left);
      top: var(--box-top);
      width: var(--box-width);
      text-align: var(--text-align);
      
      color: var(--text-main);
      padding: 12mm 10mm;
      border-radius: 2px;
      
      /* ë°°ê²½: ì§„í•œ ê²€ì • íˆ¬ëª…ë„ 75% */
      background: rgba(0, 0, 0, 0.75); 
      
      /* ë¸”ëŸ¬ íš¨ê³¼ */
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      
      /* ğŸ¨ [ë””ìì¸ í¬ì¸íŠ¸] ì™¼ìª½ í…Œë‘ë¦¬ì— AI ì»¬ëŸ¬ ì ìš©! */
      border-left: 6px solid var(--accent);
      
      /* ë‚˜ë¨¸ì§€ í…Œë‘ë¦¬ëŠ” ì€ì€í•˜ê²Œ */
      border-top: 1px solid rgba(255,255,255,0.1);
      border-right: 1px solid rgba(255,255,255,0.1);
      border-bottom: 1px solid rgba(255,255,255,0.1);
      
      box-shadow: 0 20px 50px rgba(0,0,0,0.5);
    }

    .kicker {
      font-family: 'Oswald', sans-serif;
      letter-spacing: 3px;
      text-transform: uppercase;
      font-size: 14px;
      
      /* ğŸ¨ ì¹´í…Œê³ ë¦¬ ê¸€ì”¨ë„ í¬ì¸íŠ¸ ì»¬ëŸ¬ë¡œ */
      color: var(--accent);
      margin-bottom: 16px;
      
      /* ë°‘ì¤„ë„ í¬ì¸íŠ¸ ì»¬ëŸ¬ */
      border-bottom: 1px solid var(--accent);
      
      display: inline-block;
      padding-bottom: 4px;
      text-shadow: 0 2px 4px rgba(0,0,0,0.8);
    }

    h1 {
      font-family: var(--font-title);
      font-size: 52px;
      line-height: 1.1;
      margin: 0 0 16px 0;
      color: var(--text-main);
      /* ê°€ë…ì„± ê·¸ë¦¼ì */
      text-shadow: 0 2px 10px rgba(0,0,0,1.0);
    }

    h3 {
      font-size: 20px;
      font-style: italic;
      font-weight: 300;
      margin: 0 0 20px 0;
      color: var(--text-sub);
      text-shadow: 0 2px 5px rgba(0,0,0,0.8);
    }

    p {
      font-size: 16px;
      line-height: 1.8;
      margin: 0;
      color: var(--text-main);
      opacity: 0.95;
      text-shadow: 0 1px 3px rgba(0,0,0,0.9);
    }

    .caption {
      margin-top: 24px;
      font-size: 12px;
      color: #cccccc;
      border-left: 2px solid var(--accent); /* ìº¡ì…˜ ë¼ì¸ë„ í¬ì¸íŠ¸ ì»¬ëŸ¬ */
      padding-left: 10px;
    }
  </style>
</head>

<body>
  <div class="page">
    {# ë°°ê²½ ì´ë¯¸ì§€ #}
    {% if images and images.main_img %}
      <img class="bg" src="{{ images.main_img }}" alt="Cover" />
    {% else %}
      <div class="bg" style="background: #222;"></div>
    {% endif %}

    <div class="overlay-box">
      {# Kicker #}
      {% set pr = data.get('planner_result', {}) %}
      <div class="kicker">{{ pr.get('selected_type', 'EDITORIAL') | replace('TYPE_', '') }}</div>    

      {# ë³¸ë¬¸ ë‚´ìš© #}
      {% set m = (data.manuscript if data.manuscript is defined and data.manuscript else None) %}
      {% if m %}
        <h1>{{ m.headline | default('Untitled') }}</h1>
        <h3>{{ m.subhead | default('') }}</h3>
        <p>{{ m.body | truncate(400) | default('') }}</p>
        {% if m.caption %}
          <div class="caption">{{ m.caption }}</div>
        {% endif %}
      
      {% elif data.content and data.content.blocks %}
        <h1>{{ data.content.blocks[0].headline | default('Untitled') }}</h1>
        <h3>{{ data.content.blocks[0].subhead | default('') }}</h3>
        <p>{{ data.content.blocks[0].body | default('') }}</p>
        {% if data.content.blocks[0].caption %}
          <div class="caption">{{ data.content.blocks[0].caption }}</div>
        {% endif %}
      
      {% else %}
        <h1>Generating Content...</h1>
        <p>Please wait while the AI writes your article.</p>
      {% endif %}
    </div>
  </div>
</body>
</html>